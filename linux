#!/bin/bash

# OpenShift Project & Pod Name
NAMESPACE="your-namespace"
POD_NAME="your-pod-name"

# Email Configuration
EMAIL_TO="recipient@example.com"
EMAIL_SUBJECT="üöÄ OpenShift Pod is Up!"
SMTP_SERVER="your-smtp-server"
SMTP_PORT="587"
EMAIL_FROM="openshift-monitor@example.com"

# Function to Send Email
send_email() {
    echo -e "Subject: $EMAIL_SUBJECT\n\nThe pod $POD_NAME is now up and running in $NAMESPACE." \
    | sendmail -S $SMTP_SERVER -f "$EMAIL_FROM" -t "$EMAIL_TO"
}

# Wait for the Pod to be in "Running" state
while true; do
    STATUS=$(oc get pod -n $NAMESPACE $POD_NAME -o jsonpath='{.status.phase}')
    if [[ "$STATUS" == "Running" ]]; then
        echo "‚úÖ $POD_NAME is now running. Sending email..."
        send_email
        break
    else
        echo "‚è≥ Waiting for $POD_NAME to be up..."
        sleep 10  # Check every 10 seconds
    fi
done
